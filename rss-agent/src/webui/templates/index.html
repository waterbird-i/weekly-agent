<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RSS Agent 控制台</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <div class="page-bg"></div>
  <div class="app-shell">
    <header class="hero">
      <div>
        <h1>RSS Agent 可视化控制台</h1>
        <p>实时查看生成过程、日志、记录与产物，并支持重跑和删除管理。</p>
      </div>
      <div class="hero-meta">
        <div>
          <span>项目路径</span>
          <strong>{{ project_root }}</strong>
        </div>
      </div>
    </header>

    <main class="layout-grid">
      <section class="panel control-panel">
        <h2>任务控制</h2>
        <form id="start-form" class="form-grid">
          <label>
            任务模式
            <select name="mode" id="mode-select">
              <option value="weekly">weekly（周刊生成）</option>
              <option value="standard">standard（通用流程）</option>
            </select>
          </label>

          <label>
            dry-run
            <select name="dry_run" id="dry-run-select">
              <option value="false">false</option>
              <option value="true">true</option>
            </select>
          </label>

          <label>
            standard 配置
            <input name="config_path" id="config-path" value="config/config.yaml" />
          </label>

          <label>
            weekly 配置
            <input name="weekly_config_path" id="weekly-config-path" value="config/weekly_config.yaml" />
          </label>

          <label>
            max_articles（standard 可选）
            <input name="max_articles" id="max-articles" type="number" min="1" placeholder="留空使用配置" />
          </label>

          <label>
            hours（standard 可选）
            <input name="hours" id="hours" type="number" min="1" placeholder="留空使用配置" />
          </label>

          <button type="submit" id="start-btn">启动任务</button>
        </form>

        <div id="form-message" class="muted"></div>
      </section>

      <section class="panel status-panel">
        <h2>当前任务</h2>
        <div id="run-summary" class="run-summary empty">请选择或启动一个任务</div>
        <div class="progress-wrap">
          <div id="progress-bar" class="progress-bar"></div>
        </div>
        <div id="stats-grid" class="stats-grid"></div>

        <div class="action-row">
          <button id="rerun-btn" type="button" disabled>重跑</button>
          <button id="delete-btn" type="button" disabled>删除记录</button>
          <button id="delete-artifact-btn" type="button" disabled>删除记录+产物</button>
          <button id="preview-btn" type="button" disabled>预览产物</button>
        </div>
      </section>

      <section class="panel records-panel">
        <div class="panel-title">
          <h2>生成记录</h2>
          <button id="refresh-runs-btn" type="button">刷新</button>
        </div>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>模式</th>
                <th>状态</th>
                <th>阶段</th>
                <th>开始时间</th>
              </tr>
            </thead>
            <tbody id="runs-table-body"></tbody>
          </table>
        </div>
      </section>

      <section class="panel logs-panel">
        <div class="panel-title">
          <h2>实时日志</h2>
          <div class="filters">
            <select id="level-filter">
              <option value="ALL">全部级别</option>
              <option value="INFO">INFO</option>
              <option value="WARNING">WARNING</option>
              <option value="ERROR">ERROR</option>
            </select>
            <input id="text-filter" placeholder="搜索日志关键字" />
          </div>
        </div>
        <div id="logs-view" class="logs-view"></div>
      </section>

      <section class="panel artifact-panel">
        <div class="panel-title">
          <h2>产物预览</h2>
          <span id="artifact-path" class="muted"></span>
        </div>
        <pre id="artifact-content" class="artifact-content">暂无产物</pre>
      </section>
    </main>
  </div>

  <script src="/static/app.js"></script>
</body>
</html>
